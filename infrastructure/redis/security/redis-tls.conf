# Redis TLS/SSL Configuration for Production
# ForgeFlow v2 Security Hardened Setup

# TLS/SSL Configuration
tls-port 6380
port 0  # Disable non-TLS port for security

# Certificate Files
tls-cert-file /etc/redis/tls/redis.crt
tls-key-file /etc/redis/tls/redis.key
tls-ca-cert-file /etc/redis/tls/ca.crt

# Optional DH parameters for enhanced security
tls-dh-params-file /etc/redis/tls/dhparam.pem

# TLS Protocol Configuration
tls-protocols "TLSv1.2 TLSv1.3"
tls-ciphers "ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256"
tls-ciphersuites "TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256"

# Client Certificate Verification
tls-ca-cert-file /etc/redis/tls/ca.crt
tls-ca-cert-dir /etc/redis/tls/ca-certs

# TLS Session Configuration
tls-session-caching yes
tls-session-cache-size 20480
tls-session-cache-timeout 300

# Security Options
tls-prefer-server-ciphers yes

# Replication TLS (for master-slave)
tls-replication yes

# Cluster TLS (for cluster mode)
tls-cluster yes

# Additional TLS Settings
tls-auth-clients yes  # Require client certificates

# Performance Tuning
tcp-nodelay yes
tcp-keepalive 300

# Logging TLS Events
loglevel notice
syslog-enabled yes
syslog-ident redis-tls