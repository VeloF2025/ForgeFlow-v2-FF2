# Redis ACL Configuration for ForgeFlow v2
# Fine-grained access control for different service components

# Admin user - full access
user admin on >${REDIS_ADMIN_PASSWORD} ~* &* +@all

# ForgeFlow Application User - limited to specific operations
user forgeflow on >${REDIS_FORGEFLOW_PASSWORD} ~forgeflow:* ~locks:* ~tasks:* ~teams:* ~sessions:* +@read +@write +@list +@hash +@set +@stream +@pubsub +ping +info +client +eval +evalsha -@dangerous

# Distributed Lock Service User
user lockservice on >${REDIS_LOCK_PASSWORD} ~locks:* ~sessions:* +@read +@write +@string +ping +eval +evalsha +expire +ttl +exists +del

# Team Communication User
user teamcomm on >${REDIS_TEAM_PASSWORD} ~teams:* ~messages:* ~notifications:* +@read +@write +@pubsub +@stream +ping +info

# Monitoring User - read-only access
user monitor on >${REDIS_MONITOR_PASSWORD} ~* +@read +ping +info +config|get +client|list +memory +latency -@write -@admin

# Backup User - specific backup operations
user backup on >${REDIS_BACKUP_PASSWORD} ~* +@read +ping +info +bgsave +lastsave +debug|object -@write -@admin

# Default user - disabled for security
user default off

# Performance Monitoring User
user metrics on >${REDIS_METRICS_PASSWORD} ~* +@read +ping +info +config|get +client +memory +latency +slowlog -@write -@admin